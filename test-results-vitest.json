{
  "timestamp": "2025-11-24T08:33:09.141Z",
  "testName": "Vitest Unit Tests",
  "status": "failed",
  "error": "Command failed: pnpm test\n\u001b[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.\u001b[39m\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould render login form\u001b[22m\u001b[39m\nWarning: An update to LoginPageContent inside a test was not wrapped in act(...).\n\nWhen testing, code that causes React state updates should be wrapped into act(...):\n\nact(() => {\n  /* fire events that update state */\n});\n/* assert on the output */\n\nThis ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act\n    at LoginPageContent (C:\\SpareCarry\\app\\auth\\login\\page.tsx:27:51)\n    at Suspense\n    at LoginPage\n    at QueryClientProvider (file:///C:/SpareCarry/node_modules/.pnpm/@tanstack+react-query@5.90.10_react@18.3.1/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)\n    at AllTheProviders (C:\\SpareCarry\\tests\\utils\\test-utils.tsx:15:28)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould show error message on failed login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould handle OAuth login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[90mstderr\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould handle OAuth login\u001b[22m\u001b[39m\nWarning: The current testing environment is not configured to support act(...)\n\n\u001b[31m⎯⎯⎯⎯⎯⎯⎯\u001b[1m\u001b[7m Failed Tests 1 \u001b[27m\u001b[22m⎯⎯⎯⎯⎯⎯⎯\u001b[39m\n\n\u001b[31m\u001b[1m\u001b[7m FAIL \u001b[27m\u001b[22m\u001b[39m tests/integration/api/subscription-flow.test.ts\u001b[2m > \u001b[22mSubscription API Routes\u001b[2m > \u001b[22mPOST /api/subscriptions/create-checkout\u001b[2m > \u001b[22mshould validate priceId parameter\n\u001b[31m\u001b[1mError\u001b[22m: Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\u001b[39m\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\u001b[22m\u001b[39m\n\n",
  "duration": "22.56s",
  "output": " WARN  Unsupported engine: wanted: {\"node\":\"22.x\"} (current: {\"node\":\"v24.11.1\",\"pnpm\":\"10.22.0\"})\n\n> sparecarry@0.1.0 test C:\\SpareCarry\n> cross-env NODE_ENV=test vitest run\n\n\n\u001b[7m\u001b[1m\u001b[36m RUN \u001b[39m\u001b[22m\u001b[27m \u001b[36mv1.6.1\u001b[39m \u001b[90mC:/SpareCarry\u001b[39m\n\n \u001b[32m✓\u001b[39m tests/karma.test.ts \u001b[2m (\u001b[22m\u001b[2m10 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[90m 12\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/integration/api/notifications.test.ts \u001b[2m (\u001b[22m\u001b[2m3 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[90m 18\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/unit/utils/payoutEstimator.test.ts \u001b[2m (\u001b[22m\u001b[2m7 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[90m 75\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/stripeFees.test.ts \u001b[2m (\u001b[22m\u001b[2m15 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[90m 18\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/countries.test.ts \u001b[2m (\u001b[22m\u001b[2m13 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[90m 51\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/shippingFees.test.ts \u001b[2m (\u001b[22m\u001b[2m12 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[90m 15\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/unit/lib/pricing/platform-fee.test.ts \u001b[2m (\u001b[22m\u001b[2m5 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[90m 32\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/unit/lib/matching/match-score.test.ts \u001b[2m (\u001b[22m\u001b[2m5 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[90m 29\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/integration/api/payments/create-intent.test.ts \u001b[2m (\u001b[22m\u001b[2m2 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[90m 49\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/validateCountry.test.ts \u001b[2m (\u001b[22m\u001b[2m13 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[90m 11\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/integration/api/matches/auto-match.test.ts \u001b[2m (\u001b[22m\u001b[2m3 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[90m 43\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/integration/api/payment-flow.test.ts \u001b[2m (\u001b[22m\u001b[2m5 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[33m 3222\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/unit/utils/getDaysLeft.test.ts \u001b[2m (\u001b[22m\u001b[2m4 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[90m 8\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/unit/lib/matching/smart-matching.test.ts \u001b[2m (\u001b[22m\u001b[2m3 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[90m 3\u001b[2mms\u001b[22m\u001b[39m\n\u001b[90mstdout\u001b[2m | tests/unit/components/auth/login.test.tsx\u001b[2m > \u001b[22m\u001b[2mLoginPage\u001b[2m > \u001b[22m\u001b[2mshould submit magic link form with email\u001b[22m\u001b[39m\nSending magic link to: test@example.com\nCallback URL: http://localhost:3000/auth/callback?redirect=%2Fhome\nPlatform: web\n\n \u001b[33m❯\u001b[39m tests/integration/api/subscription-flow.test.ts \u001b[2m (\u001b[22m\u001b[2m8 tests\u001b[22m \u001b[2m|\u001b[22m \u001b[31m1 failed\u001b[39m\u001b[2m)\u001b[22m\u001b[33m 5074\u001b[2mms\u001b[22m\u001b[39m\n\u001b[31m   \u001b[33m❯\u001b[31m tests/integration/api/subscription-flow.test.ts\u001b[2m > \u001b[22mSubscription API Routes\u001b[2m > \u001b[22mPOST /api/subscriptions/create-checkout\u001b[2m > \u001b[22mshould validate priceId parameter\u001b[39m\n\u001b[31m     → Test timed out in 5000ms.\nIf this is a long-running test, pass a timeout value as the last argument or configure it globally with \"testTimeout\".\u001b[39m\n \u001b[32m✓\u001b[39m tests/integration/api/auto-release.test.ts \u001b[2m (\u001b[22m\u001b[2m2 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[33m 2042\u001b[2mms\u001b[22m\u001b[39m\n\u001b[90mstdout\u001b[2m | tests/home.cta.test.tsx\u001b[2m > \u001b[22m\u001b[2mHome CTA buttons\u001b[2m > \u001b[22m\u001b[2mnavigates to login when plane button clicked\u001b[22m\u001b[39m\nPlane button clicked\nButton clicked: plane\nChecking authentication...\nAuth check result: { user: \u001b[90mundefined\u001b[39m, error: \u001b[1mnull\u001b[22m }\nUser not authenticated, navigating to login\n\n \u001b[32m✓\u001b[39m tests/home.cta.test.tsx \u001b[2m (\u001b[22m\u001b[2m1 test\u001b[22m\u001b[2m)\u001b[22m\u001b[33m 597\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/unit/components/auth/login.test.tsx \u001b[2m (\u001b[22m\u001b[2m4 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[33m 4971\u001b[2mms\u001b[22m\u001b[39m\n \u001b[32m✓\u001b[39m tests/unit/components/forms/post-request-form.test.tsx \u001b[2m (\u001b[22m\u001b[2m3 tests\u001b[22m\u001b[2m)\u001b[22m\u001b[33m 4682\u001b[2mms\u001b[22m\u001b[39m\n\n\u001b[2m Test Files \u001b[22m \u001b[1m\u001b[31m1 failed\u001b[39m\u001b[22m\u001b[2m | \u001b[22m\u001b[1m\u001b[32m18 passed\u001b[39m\u001b[22m\u001b[90m (19)\u001b[39m\n\u001b[2m      Tests \u001b[22m \u001b[1m\u001b[31m1 failed\u001b[39m\u001b[22m\u001b[2m | \u001b[22m\u001b[1m\u001b[32m117 passed\u001b[39m\u001b[22m\u001b[90m (118)\u001b[39m\n\u001b[2m   Start at \u001b[22m 18:02:48\n\u001b[2m   Duration \u001b[22m 19.50s\u001b[2m (transform 5.41s, setup 15.82s, collect 17.59s, tests 20.95s, environment 83.37s, prepare 22.74s)\u001b[22m\n\n ELIFECYCLE  Test failed. See above for more details.\n"
}